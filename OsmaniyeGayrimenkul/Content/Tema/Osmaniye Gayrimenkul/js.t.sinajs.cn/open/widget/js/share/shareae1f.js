STK.register("common.login.login",function(a){var b,c=parseInt(+(new Date)/1e6),d="../../tjs.sjs.sinajs.cn/t5/register/js/page/remote/loginLayer4478.js?_v="+c,e={};e.showLoginLayer=function(c){var e=a.parseURL(location.href),f=a.queryToJson(e.query);f.loginRnd=+(new Date);e=e.scheme+"://"+e.host+"/"+e.path+"?"+a.jsonToQuery(f);params=a.core.obj.parseParam({lang:"zh-cn",loginSuccessUrl:encodeURIComponent(e),currentTab:""},c||{});if(window.WBtopGlobal_loginLayer)WBtopGlobal_loginLayer(params);else{if(b)return;b=!0;a.core.io.scriptLoader({url:d,onComplete:function(){b=!1;window.WBtopGlobal_loginLayer(params)},timeout:1e4,onTimeout:function(){b=!1}})}};e.resetLoginLayer=e.destroy=e.close=function(){};return e});
typeof scope=="undefined"&&(scope={});scope.loginKit=function(){if(window.scope){var a=window.scope.current_user_weibo||window.scope.current_user_sina;if(a)return{uid:a,isLogin:!!a}}if(window.$CONFIG){var a=window.$CONFIG.current_user_weibo||window.$CONFIG.current_user_sina||window.$CONFIG.uid||window.$CONFIG.$uid;if(a)return{uid:a,isLogin:!!a}}var b=document.cookie+";",c=["SUP","=([^;]*)?;"].join(""),d=["(\\?|&)","uid","=([^&]*)(&|$)"].join(""),e=b.match(new RegExp(c,"i"));e=e?e[1]||"":"";e=unescape(e);var a=e.match(new RegExp(d));a=a?a[2]||"":"";var f=scope.$oid;return{uid:a,isLogin:!!a,isAdmin:a&&f&&a==f}};scope.$isLogin=function(){return scope.loginKit().isLogin};scope.$isAdmin=function(){return scope.loginKit().isAdmin};
STK.register("common.editor.getLength",function(a){return function(b){var c=41,d=140,e=20,f=b,g=b.match(/(http:|https:)?\/\/[a-zA-Z0-9]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z_\$\.\+\!\*\(\)\/\,\:;@&=\?~#%]*)*/gi)||[],h=0;for(var i=0,j=g.length;i<j;i++){var k=a.core.str.bLength(g[i]);if(/^(http:\/\/t.cn)|(https:\/\/t.cn)|(\/\/t.cn)/.test(g[i]))continue;/^(http:\/\/|https:\/\/|\/\/)+(t.sina.com.cn|t.sina.cn)/.test(g[i])||/^(http:\/\/|https:\/\/|\/\/)+(weibo.com|weibo.cn)/.test(g[i])?h+=k<=c?k:k<=d?e:k-d+e:h+=k<=d?e:k-d+e;f=f.replace(g[i],"")}var l=Math.ceil((h+a.core.str.bLength(f))/2);return l}});
STK.register("kit.dom.cssText",function(a){var b=function(a,b){var c=(a+";"+b).replace(/(\s*(;)\s*)|(\s*(:)\s*)/g,"$2$4"),d;while(c&&(d=c.match(/(^|;)([\w\-]+:)([^;]*);(.*;)?\2/i)))c=c.replace(d[1]+d[2]+d[3],"");return c};return function(a){a=a||"";var c=[],d={push:function(a,b){c.push(a+":"+b);return d},remove:function(a){for(var b=0;b<c.length;b++)c[b].indexOf(a+":")==0&&c.splice(b,1);return d},getStyleList:function(){return c.slice()},getCss:function(){return b(a,c.join(";"))}};return d}});
STK.register("common.listener",function(a){var b={},c={};c.define=function(c,d){if(b[c]!=null)throw"common.listener.define: 频道已被占用";b[c]=d;var e={};e.register=function(d,e){if(b[c]==null)throw"common.listener.define: 频道未定义";a.listener.register(c,d,e)};e.fire=function(d,e){if(b[c]==null)throw"commonlistener.define: 频道未定义";a.listener.fire(c,d,e)};e.remove=function(b,d){a.listener.remove(c,b,d)};e.cache=function(b){return a.listener.cache(c,b)};return e};return c});
STK.register("kit.dom.isTurnoff",function(a){return function(a){return!a.parentNode||a.parentNode.nodeType==11||!!a.disabled}});
STK.register("kit.extra.textareaUtils",function(a){var b={},c=document.selection;b.selectionStart=function(a){if(!c)try{return a.selectionStart}catch(b){return 0}var d=c.createRange(),e,f,g=0,h=document.body.createTextRange();h.moveToElementText(a);for(g;h.compareEndPoints("StartToStart",d)<0;g++)h.moveStart("character",1);return g};b.selectionBefore=function(a){return a.value.slice(0,b.selectionStart(a))};b.selectText=function(a,b,d){a.focus();if(!c)a.setSelectionRange(b,d);else{var e=a.createTextRange();e.collapse(1);e.moveStart("character",b);e.moveEnd("character",d-b);e.select()}};b.insertText=function(a,d,e,f){a.focus();f=f||0;if(!c){var g=a.value,h=e-f,i=h+d.length;a.value=g.slice(0,h)+d+g.slice(e,g.length);b.selectText(a,i,i)}else{var j=c.createRange();j.moveStart("character",-f);j.text=d}};b.replaceText=function(a,d){a.focus();var e=a.value,f=b.getSelectedText(a),g=f.length;if(f.length==0)b.insertText(a,d,b.getCursorPos(a));else{var h=b.getCursorPos(a);if(!c){var j=h+f.length;a.value=e.slice(0,h)+d+e.slice(h+g,e.length);b.setCursor(a,h+d.length);return}var i=c.createRange();i.text=d;b.setCursor(a,h+d.length)}};b.getCursorPos=function(a){var b=0;if(STK.core.util.browser.IE){a.focus();var d=null;d=c.createRange();var e=d.duplicate();e.moveToElementText(a);e.setEndPoint("EndToEnd",d);a.selectionStart=e.text.length-d.text.length;a.selectionEnd=a.selectionStart+d.text.length;b=a.selectionStart}else if(a.selectionStart||a.selectionStart=="0")b=a.selectionStart;return b};b.getSelectedText=function(a){var b="",d=function(a){return a.selectionStart!=undefined&&a.selectionEnd!=undefined?a.value.substring(a.selectionStart,a.selectionEnd):""};window.getSelection?b=d(a):b=c.createRange().text;return b};b.setCursor=function(a,b,c){b=b==null?a.value.length:b;c=c==null?0:c;a.focus();if(a.createTextRange){var d=a.createTextRange();d.move("character",b);d.moveEnd("character",c);d.select()}else a.setSelectionRange(b,b+c)};b.unCoverInsertText=function(a,b,c){c=c==null?{}:c;c.rcs=c.rcs==null?a.value.length:c.rcs*1;c.rccl=c.rccl==null?0:c.rccl*1;var d=a.value,e=d.slice(0,c.rcs),f=d.slice(c.rcs+c.rccl,d==""?0:d.length);a.value=e+b+f;this.setCursor(a,c.rcs+(b==null?0:b.length))};return b});
STK.register("module.at",function(a){var b=window,c=document,d=a.core.util.browser,e="font-family:Tahoma,宋体;",f=a.kit.extra.textareaUtils.selectionStart,g,h,i,j,k,l=function(){var a={"<":"&lt;",">":"&gt;",'"':"&quot;","\\":"&#92;","&":"&amp;","'":"&#039;","\r":"","\n":"<br>"," ":(navigator.userAgent.match(/.+(?:ie) ([\d.]+)/i)||[8])[1]<8?['<pre style="overflow:hidden;display:inline;',e,'word-wrap:break-word;"> </pre>'].join(""):['<span style="white-space:pre-wrap;',e,'"> </span>'].join("")};return function(b){var c=b.replace(/(<|>|\"|\\|&|\'|\n|\r| )/g,function(b){return a[b]});return c}}(),m=function(){var b=[],c=g.textEl.style.cssText,d;a.foreach(["margin","padding","border"],function(c){a.foreach(["Top","Left","Bottom","Right"],function(d){var e;c!="border"?e=b.push(c,"-",d.toLowerCase(),":",a.getStyle(g.textEl,c+d),";"):a.foreach(["Color","Style","Width"],function(e){b.push(c,"-",d.toLowerCase(),"-",e.toLowerCase(),":",a.getStyle(g.textEl,[c,d,e].join("")),";")})})});b.push("font-size:"+a.getStyle(g.textEl,"fontSize")+";");return a.kit.dom.cssText([c,b.join(""),e,"word-wrap: break-word;line-height: 18px;overflow-y:auto;overflow-x:hidden;outline:none;"].join("")).getCss()},n=function(){var b=a.builder(['<div node-type="wrap" style="display:none;">','<span node-type="before"></span>','<span node-type="flag"></span>','<span node-type="after"></span>',"</div>"].join("")).list,e=b.wrap[0],f=b.flag[0],h=b.after[0],i=b.before[0],j=0,n,o,p,q=function(a){return d.MOZ?-2:d.MOBILE&&d.SAFARI&&(d.IPAD||d.ITOUCH||d.IPHONE)?-2:0};return{bind:function(){if(o!==g.textEl){k=a.position(g.textEl);var b=["left:",k.l,"px;top:",k.t+20,"px;"].join("");o=g.textEl;var d=m();o.style.cssText=d;p=[b,d,"position:absolute;filter:alpha(opacity=0);opacity:0;z-index:-1000;"].join("");e.style.cssText=p;if(!j){j=1;c.body.appendChild(e)}}},content:function(b,c,d,j){e.style.cssText=[p,"width:",(o.offsetWidth||parseInt(a.getStyle(o,"width")))+q(),"px;height:",o.offsetHeight||parseInt(a.getStyle(o,"height")),"px;overflow-x:hidden;overflow-y:",/webkit/i.test(navigator.userAgent)?"hidden":a.getStyle(o,"overflowY"),";"].join("");i.innerHTML=l(b);f.innerHTML=l(c)||"&thinsp;";h.innerHTML=l([d,j].join(""));clearTimeout(n);n=setTimeout(function(){var b=a.position(f);a.custEvent.fire(g.eId,"at",{t:b.t-o.scrollTop-k.t+5,l:b.l-k.l+5,key:d,flag:c,textarea:g.textEl})},30)},hide:function(){e.style.display="none"},show:function(){e.style.display=""}}}(),o=function(){if(a.kit.dom.isTurnoff(g.textEl))clearInterval(h);else{var b=g.textEl.value.replace(/\r/g,""),c=f(g.textEl);if(c<0||c==j)return;j=c;var d=b.slice(0,c),e=d.match(new RegExp(["(",g.flag,")([a-zA-Z0-9一-龥_]{0,20})$"].join("")));if(!e){a.custEvent.fire(g.eId,"hidden");return}var i=b.slice(c);d=d.slice(0,-e[0].length);n.content(d,e[1],e[2],i)}};return function(b){if(!!b&&!!b.textEl){b=a.parseParam({textEl:null,flag:"@",eId:a.custEvent.define({},["at","hidden"])},b);var c=function(){if(!!g){clearInterval(h);a.removeEvent(g.textEl,"blur",c);n.hide()}},d=function(){c();g=b;j=null;n.bind();n.show();h=setInterval(o,200);a.addEvent(b.textEl,"blur",c)};a.addEvent(b.textEl,"focus",d);return b.eId}}});
STK.register("kit.extra.merge",function(a){return function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}});
STK.register("core.str.trim",function(a){return function(a){if(typeof a!="string")throw"trim need a string as parameter";var b=a.length,c=0,d=/(\u3000|\s|\t|\u00A0)/;while(c<b){if(!d.test(a.charAt(c)))break;c+=1}while(b>c){if(!d.test(a.charAt(b-1)))break;b-=1}return a.slice(c,b)}});
STK.register("core.json.jsonToQuery",function(a){var b=function(b,c){b=b==null?"":b;b=a.core.str.trim(b.toString());return c?encodeURIComponent(b):b};return function(a,c){var d=[];if(typeof a=="object")for(var e in a){if(e==="$nullName"){d=d.concat(a[e]);continue}if(a[e]instanceof Array)for(var f=0,g=a[e].length;f<g;f++)d.push(e+"="+b(a[e][f],c));else typeof a[e]!="function"&&d.push(e+"="+b(a[e],c))}return d.length?d.join("&"):""}});
STK.register("common.log.monitor",function(a){var b=window.location.protocol=="https:"?"https:":"http:",c=b+"//www.weibojs.com/log/widget.php",d={refer:document.referrer,title:document.title,ua:window.navigator.userAgent,os:window.navigator.platform+"|"+window.navigator.oscpu},e=!0,f=function(a){var b=new Image;e&&(b.src=a);b=null};return function(b){var e={},g=a.kit.extra.merge(d,b),h=[];for(var i in g){var j=g[i];typeof j=="object"&&(j=a.core.json.jsonToQuery(j));h.push(i+"="+encodeURIComponent(j))}var k=c+"?"+h.join("&");f(k);e.monitor=f;return e}});
STK.register("kit.io.ajax",function(a){return function(b){var c,d,e,f,g,h,i,j=function(b){a.common.log.monitor({url:document.location.protocol+"//"+document.location.hostname+(c.url.charAt(0)=="/"?c.url:"/"+c.url),param:c.args,method:c.method,result:b&&(b.code||0),httpcode:f.status})};h=function(a){g=!1;b.onComplete(a,c.args);setTimeout(k,0)};i=function(a){g=!1;b.onFail&&b.onFail(a,c.args);j(a);setTimeout(k,0)};e=[];f=null;g=!1;c=a.parseParam({url:"",method:"get",responseType:"json",timeout:3e4,onTraning:a.funcEmpty,isEncode:!0},b);c.onComplete=h;c.onFail=i;var k=function(){if(!!e.length){if(g===!0)return;g=!0;c.args=e.shift();f=a.ajax(c)}},l=function(a){while(e.length)e.shift();g=!1;if(f)try{f.abort()}catch(b){}f=null};d={};d.request=function(a){a||(a={});b.noQueue&&l();if(!b.uniqueRequest||!f){e.push(a);a._t=0;k()}};d.abort=l;return d}});
STK.register("kit.io.jsonp",function(a){return function(b){var c,d,e,f,g;c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:3e4,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:!0},b);e=[];f={};g=!1;var h=function(){if(!!e.length){if(g===!0)return;g=!0;f.args=e.shift();f.onComplete=function(a){g=!1;c.onComplete(a,f.args);setTimeout(h,0)};f.onFail=function(a){g=!1;c.onFail(a);setTimeout(h,0)};a.jsonp(a.kit.extra.merge(c,{args:f.args,onComplete:function(a){f.onComplete(a)},onFail:function(a){try{f.onFail(a)}catch(b){}}}))}};d={};d.request=function(a){a||(a={});e.push(a);a._t=1;h()};d.abort=function(a){while(e.length)e.shift();g=!1;f=null};return d}});
STK.register("kit.io.inter",function(a){return function(){var b,c,d;b={};c={};d={};b.register=function(a,b){if(c[a]!==undefined)throw a+" interface has been registered";c[a]=b;d[a]={}};b.hookComplete=function(b,c){var e=a.core.util.getUniqueKey();d[b][e]=c;return e};b.removeHook=function(a,b){d[a]&&d[a][b]&&delete d[a][b]};b.getTrans=function(b,e){var f=a.kit.extra.merge(c[b],e);f.onComplete=function(a,c){try{e.onComplete(a,c)}catch(f){}if(a.code==="100000")try{e.onSuccess(a,c)}catch(f){}else try{e.onError(a,c)}catch(f){}for(var g in d[b])try{d[b][g](a,c)}catch(f){}};return c[b].requestMode==="jsonp"?a.kit.io.jsonp(f):c[b].requestMode==="ijax"?a.kit.io.ijax(f):a.kit.io.ajax(f)};b.request=function(b,e,f){var g=a.core.json.merge(c[b],e);g.onComplete=function(a,c){try{e.onComplete(a,c)}catch(f){}if(a.code==="100000")try{e.onSuccess(a,c)}catch(f){}else try{if(a.code==="100002"){window.location.href=a.data;return}e.onError(a,c)}catch(f){}for(var g in d[b])try{d[b][g](a,c)}catch(f){}};g=a.core.obj.cut(g,["noqueue"]);g.args=f;return c[b].requestMode==="jsonp"?a.jsonp(g):c[b].requestMode==="ijax"?a.ijax(g):a.ajax(g)};return b}});
STK.register("common.trans.editor",function(a){var b=location.host=="widget.weibo.com"||location.host=="dev.weibo.com"?"":"/widget",c=a.kit.io.inter(),d=c.register;d("face",{url:b+"/public/aj_getemotions.php"});d("at",{url:b+"/public/aj_atusers.php"});return c});
STK.register("module.suggest",function(a){var b=null,c=a.custEvent,d=c.define,e=c.fire,f=c.add,g=a.addEvent,h=a.removeEvent,i=a.stopEvent,j=[],k={},l={ENTER:13,ESC:27,UP:38,DOWN:40,TAB:9},m=function(b){var c=-1,j=[],k=b.textNode,m=b.uiNode,n=a.core.evt.delegatedEvent(m),o=d(k,["open","close","indexChange","onSelect","onIndexChange","onClose","onOpen","openSetFlag"]);o.setFlag=p;var p=function(a){b.flag=a},q=function(){return a.sizzle(["[action-type=",b.actionType,"]"].join(""),m)},r=function(){c=-1;h(k,"keydown",s);n.destroy()},s=function(a){var d,f;if(!!(d=a)&&!!(f=d.keyCode)){if(f==l.ENTER){i();e(o,"onSelect",[c,k,b.flag]);return!1}if(f==l.UP){i();var g=q().length;c=c<1?g-1:c-1;e(o,"onIndexChange",[c]);return!1}if(f==l.DOWN){i();var g=q().length;c=c==g-1?0:c+1;e(o,"onIndexChange",[c]);return!1}if(f==l.ESC){i();r();e(o,"onClose");return!1}if(f==l.TAB){r();e(o,"onClose");return!1}}},t=function(c){e(o,"onSelect",[a.core.arr.indexOf(c.el,q()),k,b.flag])},u=function(b){c=a.core.arr.indexOf(b.el,q());e(o,"onIndexChange",[a.core.arr.indexOf(b.el,q())])};f(o,"open",function(a,c){k=c;r();g(c,"keydown",s);n.add(b.actionType,"mouseover",u);n.add(b.actionType,"click",t);e(o,"onOpen",[b.flag])});f(o,"openSetFlag",function(a,b){p(b)});f(o,"close",function(){r();e(o,"onClose",[b.flag])});f(o,"indexChange",function(a,d){c=d;e(o,"onIndexChange",[c,b.flag])});return o},n=function(b){var c=b.textNode,d=a.core.arr.indexOf(c,j);if(!k[d]){j[d=j.length]=c;k[d]=m(b)}return k[d]};return function(c){if(!!c.textNode&&!!c.uiNode){c=a.parseParam({textNode:b,uiNode:b,actionType:"item",actionData:"index",flag:""},c);return n(c)}}});
STK.register("common.channel.at",function(a){var b=["open","close"];return a.common.listener.define("common.channel.at",b)});
STK.register("kit.extra.language",function(a){window.$LANG||(window.$LANG={});return function(b,c){var d=a.core.util.language(b,$LANG);d=d.replace(/\\}/ig,"}");c&&(d=a.templet(d,c));return d}});
STK.register("kit.dom.firstChild",function(a){var b=a.core.dom.next;return function(a){var c=a.firstChild;c&&c.nodeType!=1&&(c=b(c));return c}});
STK.register("kit.dom.layoutPos",function(a){return function(b,c,d){if(!a.isNode(c))throw"kit.dom.layerOutElement need element as first parameter";if(c===document.body)return!1;if(!c.parentNode)return!1;if(c.style.display==="none")return!1;var e,f,g,h,i,j,k;e=a.parseParam({pos:"left-bottom",offsetX:0,offsetY:0},d);f=c;if(!f)return!1;while(f!==document.body){f=f.parentNode;if(f.style.display==="none")return!1;j=a.getStyle(f,"position");k=f.getAttribute("layout-shell");if(j==="absolute"||j==="fixed")break;if(k==="true"&&j==="relative")break}f.appendChild(b);g=a.position(c,{parent:f});h={w:c.offsetWidth,h:c.offsetHeight};i=e.pos.split("-");i[0]==="left"?b.style.left=g.l+e.offsetX+"px":i[0]==="right"?b.style.left=g.l+h.w+e.offsetX+"px":i[0]==="center"&&(b.style.left=g.l+h.w/2+e.offsetX+"px");i[1]==="top"?b.style.top=g.t+e.offsetY+"px":i[1]==="bottom"?b.style.top=g.t+h.h+e.offsetY+"px":i[1]==="middle"&&(b.style.top=g.t+h.h/2+e.offsetY+"px");return!0}});
STK.register("common.editor.plugin.at",function(a){var b=a.kit.extra.language,c='<div class="WB_tips_smart WB_email"><p class="tipsmt_title" node-type="suggestTitle">想用@提到谁</p><ul class="tipsmt_list" node-type="suggestWrap"></ul></div>',d={"@":{normalTitle:b("#L{选择昵称或轻敲空格完成输入}"),moreTitle:b("#L{选择最近@的人或直接输入}"),noTilte:b("#L{轻敲空格完成输入}")},"#":{normal:b("#L{想用什么话题？}")}},e={"@":'<#et temp data><#list data.data as list><li action-type="item" <#if (list_index == 0)>class="tipsmt_cur" </#if>action-data="value=${list.nickname}" value="${list.nickname}"><a href="#">${list.nickname}<#if (list.remark)>(${list.remark})</#if></a></li><#if (list.count)><span>${list.count}</span></#if></#list></#et>',"#":'<#et temp data><#list data.data as list><li action-type="item" <#if (list_index == 0)>class="cur" </#if>action-data="value=${list.topic}" value="${list.topic}"><a href="#">${list.topic}<#if (list.count)>(${list.count})</#if></a></li></#list></#et>'},f,g,h,i,j,k,l,m=!1,n,o,p={"@":"at","#":"topicList"},q=0,r=function(){setTimeout(function(){a.custEvent.fire(f,"close")},200)},s=function(){k.style.display="none"},t=function(){a.custEvent.add(f,"onIndexChange",function(a,b){y(b)});a.custEvent.add(f,"onSelect",function(b,c,d,e){q=0;a.core.evt.stopEvent();var g=o[c].getAttribute("value");g=g.replace(/\(.*\)/,"");try{d.focus()}catch(h){}var i=a.kit.extra.textareaUtils.selectionStart(d)*1,j=new RegExp(e+"([a-zA-Z0-9一-龥_]{0,20})$"),k=d.value.replace(/\r+/g,"").slice(0,i).match(j),l=d.value.slice(i,i+1);k=k&&k[1]?k[1].length:0;var m=a.kit.extra.textareaUtils;e=="#"?typeof l!="undefined"&&l!=e&&(g=g+e+" "):g=g+" ";m.insertText(d,g,i,k);var n=m.getCursorPos(d);if(e=="#"&&l==e){m.setCursor(d,n+1);m.insertText(d," ",n+1,0)}n=m.getCursorPos(d);var p=m.getSelectedText(d),r=p==""||p==null?0:p.length;d.setAttribute("range",n+"&"+r);a.custEvent.fire(f,"close")});a.addEvent(h.textEl,"blur",r);a.custEvent.add(f,"onClose",s);a.custEvent.add(f,"onOpen",function(b,c){j.style.display="";k.style.display="";m=!0;setTimeout(function(){a.custEvent.fire(f,"indexChange",0)},100)})},u=function(b,c,f){b=="@"?c.data&&c.data.length>0?c.title=f==""?d[b].moreTitle:d[b].normalTitle:c.title=d[b].noTilte:c.title=d[b].normalTitle;var g=a.core.util.easyTemplate(e[b],c);return g},v=function(){a.core.evt.custEvent.add(g,"hidden",function(b,c){a.custEvent.fire(f,"close")});a.core.evt.custEvent.add(g,"at",function(b,c){l=c.key;var e=c.flag;if(l.length==0&&e!="@")a.custEvent.fire(f,"close");else{var g=document.location.host=="widget.weibo.com"?"":"/widget";a.core.io.ajax({url:g+"/public/aj_atusers.php",args:{wsrc:$CONFIG.wsrc||"app_comment_box",appkey:$CONFIG.source_appkey||$CONFIG.appkey||$CONFIG.app_src,q:l},onComplete:function(b){if(b.code=="100000"){var g=u(e,b,l);a.custEvent.fire(f,"openSetFlag",e);a.custEvent.fire(f,"open",c.textarea);var h=a.core.dom.builder(g),m=h.box;j.innerHTML=m;j.style.display=b.data.length==0?"none":"";i.innerHTML=l.length==0?d["@"].moreTitle:d["@"].normalTitle;k.style.cssText=["z-index:11001;background-color:#ffffff;position:absolute;"].join("");a.common.channel.at.fire("open");a.kit.dom.layoutPos(k,c.textarea,{pos:"left-top",offsetX:c.l,offsetY:c.t})}else a.custEvent.fire(f,"close")},onFail:function(){a.custEvent.fire(f,"close")}})}})},w=function(){n=h.textEl;g=STK.module.at({textEl:n,flag:"@"})},x=function(b){q=0;k&&(k.style.display="none");k&&(k.innerHTML="");var d=a.builder(c);k=a.kit.dom.firstChild(d.box);k.style.display="none";document.body.appendChild(k);i=d.list.suggestTitle[0];j=d.list.suggestWrap[0];f&&a.custEvent.fire(f,"close");f&&a.custEvent.remove(f);f=a.module.suggest({textNode:b,uiNode:j,actionType:"item",actionData:"value",flag:"@"});t()},y=function(b){o=a.sizzle("li",j);o&&o[0]&&a.core.dom.removeClassName(o[q],"tipsmt_cur");a.core.dom.addClassName(o[b],"tipsmt_cur");q=b};return function(a,b){h=a.nodeList;var c={};c.init=function(){w();x(h.textEl);v()};return c}});
STK.register("common.editor.simpleEditor",function(a){var b=a.core.str.trim,c,d=a.common.editor.getLength,e=function(a,b){var c=d(a),e=Math.abs(b-c),f;c>b||c<1?f={wordsnum:c,vnum:e,overflow:!0}:c==0?f={wordsnum:c,vnum:e,overflow:!0}:f={wordsnum:c,vnum:e,overflow:!1};return f};return function(d,f){f=f||{};var g=f.limit||140;if(!d)throw"[easyEditor]: editor is null";a.custEvent.define(d,"textNum");a.custEvent.define(d,"keyUpCount");var h=a.sizzle('[node-type="editor"]',d)[0],i=a.sizzle('[node-type="wordNum"]',d)[0];if(f.atSwitch!=null&&f.atSwitch==!0){var j=a.common.editor.plugin.at({nodeList:{textEl:h}},f);j.init()}a.addEvent(h,"focus",function(){c=setInterval(function(){k()},200)});a.addEvent(h,"blur",function(){c&&clearInterval(c)});var k=function(){var c=b(h.value).length==0?b(h.value):h.value;c=c.replace(/\r\n/g,"\n");var j=e(c,g);c.length>=0&&h.focus?j.overflow&&j.wordsnum!=0?i.className=f.warnClassName?f.warnClassName:"WB_tipS_numWarn":i.className=f.className?f.className:"WB_tipS_num":c.length===0&&(i.className=f.className?f.className:"WB_tipS_num");c.length!==0&&j.overflow?i.innerHTML="-"+(j.vnum>100?"n":j.vnum):i.innerHTML=j.vnum;a.custEvent.fire(d,"textNum",{count:j.wordsnum,isOver:j.overflow})};a.addEvent(h,"keyup",k);a.custEvent.add(d,"keyUpCount",k);k()}});
STK.register("common.editor.simpleEditorNew",function(a){var b=a.core.str.trim,c,d=a.common.editor.getLength,e=function(a,b){var c=d(a),e=Math.abs(b-c),f;c>b||c<1?f={wordsnum:c,vnum:e,overflow:!0}:c==0?f={wordsnum:c,vnum:e,overflow:!0}:f={wordsnum:c,vnum:e,overflow:!1};return f};return function(d,f){f=f||{};var g=f.limit||140;if(!d)throw"[easyEditor]: editor is null";a.custEvent.define(d,"textNum");a.custEvent.define(d,"keyUpCount");var h=a.sizzle('[node-type="editor"]',d)[0],i=a.sizzle('[node-type="wordNum"]',d)[0];if(f.atSwitch!=null&&f.atSwitch==!0){var j=a.common.editor.plugin.at({nodeList:{textEl:h}},f);j.init()}a.addEvent(h,"focus",function(){c=setInterval(function(){k()},200)});a.addEvent(h,"blur",function(){c&&clearInterval(c)});var k=function(){var c=b(h.value).length==0?b(h.value):h.value;c=c.replace(/\r\n/g,"\n");var j=e(c,g);c.length>=0&&h.focus?j.overflow&&j.wordsnum!=0?i.className=f.warnClassName?f.warnClassName:"WB_tipS_numWarn":i.className=f.className?f.className:"WB_tipS_num":c.length===0&&(i.className=f.className?f.className:"WB_tipS_num");c.length!==0&&j.overflow?i.innerHTML="-"+(j.vnum>100?"n":j.vnum):i.innerHTML=j.wordsnum;a.custEvent.fire(d,"textNum",{count:j.wordsnum,isOver:j.overflow})};a.addEvent(h,"keyup",k);a.custEvent.add(d,"keyUpCount",k);k()}});
STK.register("kit.dom.fix",function(a){function f(c,e,f){if(!!d(c)){var g="fixed",h,i,j,k,l=c.offsetWidth,m=c.offsetHeight,n=a.core.util.winSize(),o=0,p=0,q=a.kit.dom.cssText(c.style.cssText);if(!b){g="absolute";var r=a.core.util.scrollPos();o=h=r.top;p=i=r.left;switch(e){case"lt":h+=f[1];i+=f[0];break;case"lb":h+=n.height-m-f[1];i+=f[0];break;case"rt":h+=f[1];i+=n.width-l-f[0];break;case"rb":h+=n.height-m-f[1];i+=n.width-l-f[0];break;case"c":default:h+=(n.height-m)/2+f[1];i+=(n.width-l)/2+f[0]}j=k=""}else{h=k=f[1];i=j=f[0];switch(e){case"lt":k=j="";break;case"lb":h=j="";break;case"rt":i=k="";break;case"rb":h=i="";break;case"c":default:h=(n.height-m)/2+f[1];i=(n.width-l)/2+f[0];k=j=""}}if(e=="c"){h<o&&(h=o);i<p&&(i=p)}q.push("position",g).push("top",h+"px").push("left",i+"px").push("right",j+"px").push("bottom",k+"px");c.style.cssText=q.getCss()}}function e(b){b=a.core.arr.isArray(b)?b:[0,0];for(var c=0;c<2;c++)typeof b[c]!="number"&&(b[c]=0);return b}function d(b){return a.core.dom.getStyle(b,"display")!="none"}var b=!(a.core.util.browser.IE6||document.compatMode!=="CSS1Compat"&&STK.IE),c=/^(c)|(lt)|(lb)|(rt)|(rb)$/;return function(d,g,h){var i,j,k=!0,l;if(a.core.dom.isNode(d)&&c.test(g)){var m={getNode:function(){return d},isFixed:function(){return k},setFixed:function(a){(k=!!a)&&f(d,i,j);return this},setAlign:function(a,b){if(c.test(a)){i=a;j=e(b);k&&f(d,i,j)}return this},destroy:function(){b||b&&a.core.evt.removeEvent(window,"scroll",n);a.core.evt.removeEvent(window,"resize",n);a.core.evt.custEvent.undefine(l)}};l=a.core.evt.custEvent.define(m,"beforeFix");m.setAlign(g,h);function n(c){c=c||window.event;a.core.evt.custEvent.fire(l,"beforeFix",c.type);k&&(!b||i=="c")&&f(d,i,j)}b||a.core.evt.addEvent(window,"scroll",n);a.core.evt.addEvent(window,"resize",n);return m}}});
STK.register("module.mask",function(a){function k(b){var c;(c=b.getAttribute(f))||b.setAttribute(f,c=a.getUniqueKey());return">"+b.tagName.toLowerCase()+"["+f+'="'+c+'"]'}function j(){b=a.C("div");var c='<div node-type="outer">';a.core.util.browser.IE6&&(c+='<div style="position:absolute;width:100%;height:100%;"></div>');c+="</div>";b=a.builder(c).list.outer[0];document.body.appendChild(b);e=!0;d=a.kit.dom.fix(b,"lt");var f=function(){var c=a.core.util.winSize();b.style.cssText=a.kit.dom.cssText(b.style.cssText).push("width",c.width+"px").push("z-index","99995").push("height",c.height+"px").getCss()};i.add(d,"beforeFix",f);f()}var b,c=[],d,e=!1,f="STK-Mask-Key",g=a.core.dom.setStyle,h=a.core.dom.getStyle,i=a.core.evt.custEvent,l={getNode:function(){return b},show:function(c,f){if(e){c=a.core.obj.parseParam({opacity:.3,background:"#000000"},c);b.style.background=c.background;g(b,"opacity",c.opacity);b.style.display="";d.setAlign("lt");f&&f()}else a.Ready(function(){j();l.show(c,f)});return l},hide:function(){b.style.display="none";nowIndex=undefined;c=[];return l},showUnderNode:function(d,e){a.isNode(d)&&l.show(e,function(){g(b,"zIndex",h(d,"zIndex"));var e=k(d),f=a.core.arr.indexOf(c,e);f!=-1&&c.splice(f,1);c.push(e);a.core.dom.insertElement(d,b,"beforebegin")});return l},back:function(){if(c.length<1)return l;var d,e;c.pop();if(c.length<1)l.hide();else if((e=c[c.length-1])&&(d=a.sizzle(e,document.body)[0])){g(b,"zIndex",h(d,"zIndex"));a.core.dom.insertElement(d,b,"beforebegin")}else l.back();return l},destroy:function(){i.remove(d);b.style.display="none";lastNode=undefined;_cache={}}};return l});
STK.register("module.layer",function(a){var b=function(a){var b={};if(a.style.display=="none"){a.style.visibility="hidden";a.style.display="";b.w=a.offsetWidth;b.h=a.offsetHeight;a.style.display="none";a.style.visibility="visible"}else{b.w=a.offsetWidth;b.h=a.offsetHeight}return b},c=function(c,d){d=d||"topleft";var e=null;if(c.style.display=="none"){c.style.visibility="hidden";c.style.display="";e=a.core.dom.position(c);c.style.display="none";c.style.visibility="visible"}else e=a.core.dom.position(c);if(d!=="topleft"){var f=b(c);if(d==="topright")e.l=e.l+f.w;else if(d==="bottomleft")e.t=e.t+f.h;else if(d==="bottomright"){e.l=e.l+f.w;e.t=e.t+f.h}}return e};return function(d){var e=a.core.dom.builder(d),f=e.list.outer[0],g=e.list.inner[0],h=a.core.dom.uniqueID(f),i={},j=a.core.evt.custEvent.define(i,"show");a.core.evt.custEvent.define(j,"hide");var k=null;i.show=function(){f.style.display="";a.core.evt.custEvent.fire(j,"show");return i};i.hide=function(){f.style.display="none";a.custEvent.fire(j,"hide");return i};i.getPosition=function(a){return c(f,a)};i.getSize=function(a){if(a||!k)k=b.apply(i,[f]);return k};i.html=function(a){a!==undefined&&(g.innerHTML=a);return g.innerHTML};i.text=function(b){text!==undefined&&(g.innerHTML=a.core.str.encodeHTML(b));return a.core.str.decodeHTML(g.innerHTML)};i.appendChild=function(a){g.appendChild(a);return i};i.getUniqueID=function(){return h};i.getOuter=function(){return f};i.getInner=function(){return g};i.getParentNode=function(){return f.parentNode};i.getDomList=function(){return e.list};i.getDomListByKey=function(a){return e.list[a]};i.getDom=function(a,b){return e.list[a]?e.list[a][b||0]:!1};i.getCascadeDom=function(b,c){return e.list[b]?a.core.dom.cascadeNode(e.list[b][c||0]):!1};return i}});
STK.register("common.channel.login",function(a){var b=["login","logout"];return a.common.listener.define("common.channel.login",b)});
STK.register("common.login.getUserInfo",function(a){function b(b){a.ajax({url:"/share/aj_isopent.php",onComplete:function(c){c.code==0&&typeof b=="function"&&b(c);a.common.channel.login.fire("login",c)}})}return b});
STK.register("common.trans.share",function(a){var b=a.kit.io.inter(),c=b.register;c("attention",{url:"/share/aj_addAttention.php",method:"post"});c("group",{url:"/share/group",method:"post"});c("share",{url:"/share/aj_share.php",method:"post"});c("friend",{url:"/share/aj_messagefriends.php",method:"get"});c("addPrivateMsg",{url:"/share/aj_message.php",method:"post"});c("usernick",{url:"/ajax_get_usernick.php",method:"get"});return b});
STK.register("kit.dom.lastChild",function(a){var b=a.core.dom.prev;return function(a){var c=a.lastChild;c&&c.nodeType!=1&&(c=b(c));return c}});
STK.register("common.login.getLoginStatus",function(a){function d(){return b().isLogin}function c(){return b().uid}function b(){if(window.scope){var a=window.scope.current_user_weibo||window.scope.current_user_sina;if(a)return{uid:a,isLogin:!!a}}if(window.$CONFIG){var a=window.$CONFIG.current_user_weibo||window.$CONFIG.current_user_sina||window.$CONFIG.uid||window.$CONFIG.is_login||window.$CONFIG.$uid;if(a)return{uid:a,isLogin:!!a}}var b=document.cookie+";",c=["SUP","=([^;]*)?;"].join(""),d=["(\\?|&)","uid","=([^&]*)(&|$)"].join(""),e=b.match(new RegExp(c,"i"));e=e?e[1]||"":"";e=unescape(e);var a=e.match(new RegExp(d));a=a?a[2]||"":"";return{uid:a,isLogin:!!a}}return{uid:c,isLogin:d}});
STK.register("kit.dom.parentElementBy",function(a){return function(a,b,c){if(!a||!b)throw new Error("传入的参数为空");var d=0,e;a=a.parentNode;while(a.parentNode){d++;e=c(a);if(e===!1)return!1;if(e===!0)return a;if(e===b)return null;a=a.parentNode;if(d>3e4)return!1}return null}});
STK.register("kit.dom.parseDOM",function(a){return function(a){for(var b in a)a[b]&&a[b].length==1&&(a[b]=a[b][0]);return a}});
STK.register("comp.share.picSelector",function(a){var b=a.core.util.browser.IE6,c='<div class="WB_widget WB_widget_layer" node-type="outer"><table><tbody><tr><td><div class="layer_plain_container"><div class="layer_content"><div class="layer_content_title"><em class="layer_title_note" node-type="picInfo">&nbsp;</em></div><div class="select_img_list_container"><ul class="select_img_list" node-type="inner"></ul></div></div><a action-type="close" href="javascript:;" class="layer_close_btn layer_close_btn_large"></a></div></td></tr></tbody></table></div>',d='<#et temp data><#list data.list as img><li action-type="pics" action-data="index=${img_index}&src=${img.enSrc}" class="select_img_item"><a href="javascript:" class="select_img_link"><img alt="" src="${img.src}" class="select_img" '+(b?' width="90" height="90" ':"")+">"+'<i class="img_align_assist"></i>'+'<i class="WB_check_icon"></i>'+"</a>"+"</li>"+"</#list>"+"</#et>",e=a.kit.extra.language;return function(b,f){var g={},h,i,j,k,l,m,n=a.custEvent.define(g,["change"]),o=scope.picLst.slice(0),p=[];a.foreach(o,function(a,b){var c={enSrc:encodeURIComponent(a),src:a};p.push(c)});var q=function(){r();u();w()},r=function(){},s={list:{},add:function(a,b){this.list[a]=b},remove:function(a){delete this.list[a]},length:function(){var a=0;for(var b in this.list)a++;return a},getMin:function(){var a=[];for(var b in this.list)a.push(b);var c=Math.min.apply(Math,a);c==Infinity&&(c=-1);return c},getPicById:function(a){for(var b in this.list)if(b==a)return this.list[b];return""},getList:function(){var a=[];for(var b in this.list)a.push(this.list[b]);return a}},t={initLayer:function(){j=a.module.layer(e(c));k=j.getOuter();l=a.kit.dom.parseDOM(j.getDomList());document.body.appendChild(k);t.bindEvt();t.updateInfo();var b=a.core.util.easyTemplate(d,{list:p});j.html(b);return j},bindEvt:function(){i=a.core.evt.delegatedEvent(k);i.add("close","click",t.hide);i.add("pics","click",t.select)},select:function(b){var c=b.el,d=b.data;if(a.hasClassName(c,"select_img_added")){c.className="select_img_item";s.remove(d.index)}else{if(s.length()>=scope.max_count)return;c.className="select_img_item select_img_added";s.add(d.index,decodeURIComponent(d.src))}t.updateInfo()},updateInfo:function(){var b=s.length(),c=e("#L{已选择}"+b+"#L{张}，#L{还能选择}"+parseInt(Math.min(scope.max_count,p.length)-b)+"#L{张}");l.picInfo.innerHTML=c;var d=s.getMin(),f=s.getPicById(d);a.custEvent.fire(n,"change",[{msg:c,src:f,len:b}])},show:function(a){m=a.el;j||(j=t.initLayer());j.show();t.pos(a.el)},pos:function(b){b=b||m;if(!!b){var c=a.core.dom.position(b);c.t-=138;c.l-=13;t.setPostion(c)}},hide:function(){j&&j.hide()},setPostion:function(a){k.style.top=a.t+"px";k.style.left=a.l+"px";return g},jump:function(a){var b=decodeURIComponent(a.data.url);window.open(b)},deleShow:function(){j&&j.show()}},u=function(){},v=function(){scope.picLst.length>0&&s.add(0,scope.picLst[0])},w=function(){h=a.core.evt.delegatedEvent(b);h.add("showMark","click",t.show);h.add("jumpurl","click",t.jump)},x=function(){};q();g.destroy=x;var y=function(){return s.getList()};g.getPics=y;g.hide=t.hide;g.show=t.deleShow;g.rePos=t.pos;return g}});
STK.register("core.dom.isNode",function(a){return function(a){return a!=undefined&&Boolean(a.nodeName)&&Boolean(a.nodeType)}});
STK.register("core.util.hideContainer",function(a){var b,c=function(){if(!b){b=a.C("div");b.style.cssText="position:absolute;top:-9999px;left:-9999px;";document.getElementsByTagName("head")[0].appendChild(b)}},d={appendChild:function(d){if(a.core.dom.isNode(d)){c();b.appendChild(d)}},removeChild:function(c){a.core.dom.isNode(c)&&b&&b.removeChild(c)}};return d});
STK.register("core.dom.getSize",function(a){var b=function(b){if(!a.core.dom.isNode(b))throw"core.dom.getSize need Element as first parameter";return{width:b.offsetWidth,height:b.offsetHeight}},c=function(a){var c=null;if(a.style.display==="none"){a.style.visibility="hidden";a.style.display="";c=b(a);a.style.display="none";a.style.visibility="visible"}else c=b(a);return c};return function(b){var d={};if(!b.parentNode){a.core.util.hideContainer.appendChild(b);d=c(b);a.core.util.hideContainer.removeChild(b)}else d=c(b);return d}});
STK.register("core.util.scrollPos",function(a){return function(a){a=a||document;var b=a.documentElement,c=a.body;return{top:Math.max(window.pageYOffset||0,b.scrollTop,c.scrollTop),left:Math.max(window.pageXOffset||0,b.scrollLeft,c.scrollLeft)}}});
STK.register("core.util.browser",function(a){var b=navigator.userAgent.toLowerCase(),c=window.external||"",d,e,f,g,h,i=function(a){var b=0;return parseFloat(a.replace(/\./g,function(){return b++==1?"":"."}))};try{/windows|win32/i.test(b)?h="windows":/macintosh/i.test(b)?h="macintosh":/rhino/i.test(b)&&(h="rhino");if((e=b.match(/applewebkit\/([^\s]*)/))&&e[1]){d="webkit";g=i(e[1])}else if((e=b.match(/presto\/([\d.]*)/))&&e[1]){d="presto";g=i(e[1])}else if(e=b.match(/msie\s([^;]*)/)){d="trident";g=1;(e=b.match(/trident\/([\d.]*)/))&&e[1]&&(g=i(e[1]))}else if(/gecko/.test(b)){d="gecko";g=1;(e=b.match(/rv:([\d.]*)/))&&e[1]&&(g=i(e[1]))}/world/.test(b)?f="world":/360se/.test(b)?f="360":/maxthon/.test(b)||typeof c.max_version=="number"?f="maxthon":/tencenttraveler\s([\d.]*)/.test(b)?f="tt":/se\s([\d.]*)/.test(b)&&(f="sogou")}catch(j){}var k={OS:h,CORE:d,Version:g,EXTRA:f?f:!1,IE:/msie/.test(b),OPERA:/opera/.test(b),MOZ:/gecko/.test(b)&&!/(compatible|webkit)/.test(b),IE5:/msie 5 /.test(b),IE55:/msie 5.5/.test(b),IE6:/msie 6/.test(b),IE7:/msie 7/.test(b),IE8:/msie 8/.test(b),IE9:/msie 9/.test(b),SAFARI:!/chrome\/([\d.]*)/.test(b)&&/\/([\d.]*) safari/.test(b),CHROME:/chrome\/([\d.]*)/.test(b),IPAD:/\(ipad/i.test(b),IPHONE:/\(iphone/i.test(b),ITOUCH:/\(itouch/i.test(b),MOBILE:/mobile/i.test(b)};return k});
STK.register("core.obj.parseParam",function(a){return function(a,b,c){var d,e={};b=b||{};for(d in a){e[d]=a[d];b[d]!=null&&(c?a.hasOwnProperty[d]&&(e[d]=b[d]):e[d]=b[d])}return e}});
STK.register("core.dom.position",function(a){var b=function(b){var c,d,e,f,g,h;c=b.getBoundingClientRect();d=a.core.util.scrollPos();e=b.ownerDocument.body;f=b.ownerDocument.documentElement;g=f.clientTop||e.clientTop||0;h=f.clientLeft||e.clientLeft||0;return{l:parseInt(c.left+d.left-h,10)||0,t:parseInt(c.top+d.top-g,10)||0}},c=function(b,c){var d;d=[b.offsetLeft,b.offsetTop];parent=b.offsetParent;if(parent!==b&&parent!==c)while(parent){d[0]+=parent.offsetLeft;d[1]+=parent.offsetTop;parent=parent.offsetParent}if(a.core.util.browser.OPERA!=-1||a.core.util.browser.SAFARI!=-1&&b.style.position=="absolute"){d[0]-=document.body.offsetLeft;d[1]-=document.body.offsetTop}b.parentNode?parent=b.parentNode:parent=null;while(parent&&!/^body|html$/i.test(parent.tagName)&&parent!==c){if(parent.style.display.search(/^inline|table-row.*$/i)){d[0]-=parent.scrollLeft;d[1]-=parent.scrollTop}parent=parent.parentNode}return{l:parseInt(d[0],10),t:parseInt(d[1],10)}};return function(d,e){if(d==document.body)return!1;if(d.parentNode==null)return!1;if(d.style.display=="none")return!1;var f=a.core.obj.parseParam({parent:null},e);if(d.getBoundingClientRect){if(f.parent){var g=b(d),h=b(f.parent);return{l:g.l-h.l,t:g.t-h.t}}return b(d)}return c(d,f.parent||document.body)}});
STK.register("core.util.winSize",function(a){return function(a){var b,c,d;a?d=a.document:d=document;if(d.compatMode==="CSS1Compat"){b=d.documentElement.clientWidth;c=d.documentElement.clientHeight}else if(self.innerHeight){a?d=a.self:d=self;b=d.innerWidth;c=d.innerHeight}else if(d.documentElement&&d.documentElement.clientHeight){b=d.documentElement.clientWidth;c=d.documentElement.clientHeight}else if(d.body){b=d.body.clientWidth;c=d.body.clientHeight}return{width:b,height:c}}});
STK.register("ui.tip",function(a){var b='<div class="WB_tip_sg" node-type="outer" style="z-index=9999;"><div class="WB_tip_sg_inner"><span class="WB_tipS_warn"></span><span class="WB_icon_txt" node-type="inner"></span></div></div>';return function(c,d){d=d||{};var e,f,g,h,i,j,k,l=a.core.obj.parseParam({template:b,timeout:3e3},d),m=function(b,c,d){c=c||"left";d=a.parseParam({t:0,l:0},d);var g,i,j=a.core.dom.getSize(b),k=a.core.dom.position(b),l=e.getSize(!0);switch(c){case"left":g=k.l;i=k.t;break;case"right":g=k.l+j.width-l.w;i=k.t;break;case"center":g=k.l+(j.width-l.w)/2;i=k.t+(j.height-l.w)/2}g+=d.l;i+=d.t;f.style.top=i+"px";f.style.left=g+"px";return h},n=function(){var b=a.core.util.winSize(),c=e.getSize(!0);f.style.top=a.core.util.scrollPos().top+(b.height-c.h)/2+"px";f.style.left=(b.width-c.w)/2+"px";return h},o=function(a){typeof a=="string"?g.innerHTML=a:g.appendChild(a);p();return h},p=function(){e.show();if(l.timeout){clearTimeout(k);k=setTimeout(e.hide,l.timeout)}},q=function(){e=a.module.layer(l.template);f=e.getOuter();g=e.getDom("inner");h=e;c&&o(c);document.body.appendChild(f)};q();h.setMiddle=n;h.setContent=o;h.setPosition=m;return h}});
STK.register("common.trans.weimi",function(a){var b=a.kit.io.inter(),c=b.register;c("group",{url:"/share/aj_weimi.php?type=2",method:"get"});c("send",{url:"/share/aj_weimi.php?type=3",method:"post"});c("is_auth",{url:"/share/aj_weimi.php?type=1",method:"get"});c("register",{url:"/share/aj_weimi.php?type=4",method:"post"});return b});
STK.register("comp.share.weimiGroup",function(a){var b='<div class="WB_load_tips loading_friends"><span class="WB_loadingS"></span><span class="WB_icon_txt">正在加载，请稍候...</span></div>',c='<#et temp data><ul class="WB_userList clearfix"><#list data as list><li><a class="clearfix" href="javascript:;" action-type="group" action-data="gid=${list.gid}&name=${list.name}&img=${list.img}"><span class="sl_Uavatar"><img alt="" src="${list.img}"></span><span class="sl_Uname"><span class="name">${list.name}</span></span></a></li></#list ></ul></#et>',d='<#et temp data><div class="selected_one_exhibit clearfix"><span class="one_avatar"><img src="${data.img}" /></span><span class="one_name"><span class="name">${data.name}</span></span></div></#et>',e=a.core.util.easyTemplate,f="../../img.t.sinajs.cn/t4/appstyle/widget/images/share/wemeet_icon.png";return function(g,h){var i={},j=a.parseParam({cache_time:5},h),k,l,m;a.custEvent.define(i,["onShow","onHidden","onSelect","onLoading","onLoaded"]);var n={},o={},p={},q=function(){s();t();u();v();w();x()},r={init:function(){if(!m){m=a.C("div");m.className="slt_panel";m.style.display="none";g.appendChild(m);m.innerHTML=b;r.getData()}},show:function(){a.core.evt.stopEvent();m.style.display="block";m.scrollTop=0;a.addClassName(g.parentNode,"complete_slt");a.custEvent.fire(i,"onShow")},hide:function(){m&&(m.style.display="none");a.removeClassName(g.parentNode,"complete_slt");a.custEvent.fire(i,"onHidden")},isShow:function(){return m.style.display!="none"},setlHtml:function(a){var b=e(c,a);m.innerHTML=b},setItem:function(a){var b=e(d,a);k.inputBox.innerHTML=b},preOperate:function(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=a[c];e.img==""&&e.gid===0&&(e.img=f);b.push(e)}return b},success:function(b){var c=r.preOperate(b);r.setlHtml(c);var d=c[0];r.setItem(d);a.custEvent.fire(i,"onSelect",d)},select:function(b){a.core.evt.stopEvent();var c=b.el,d=b.data;r.setItem(d);r.hide();a.custEvent.fire(i,"onSelect",d)},getData:function(){a.custEvent.fire(i,"onLoading");var b=a.common.trans.weimi.getTrans("group",{onComplete:function(b){if(b.code==="100000"){r.success(b.data);a.custEvent.fire(i,"onLoaded")}},onFail:r.fail}).request({})}},s=function(){if(g==null||g!=null&&!a.core.dom.isNode(g))throw"[comp.share.weimiGroup]:argsCheck()-The param node is not a DOM node."},t=function(){k=a.kit.dom.parseDOM(a.core.dom.builder(g).list)},u=function(){},v=function(){l=a.core.evt.delegatedEvent(g);l.add("group","click",r.select);a.addEvent(document.body,"click",r.hide)},w=function(){},x=function(){},y=function(){l=null;l.remove("group","click",r.select);a.removeEvent(document.body,"click",r.hide)};q();i.destroy=y;i.show=r.show;i.isShow=r.isShow;i.hide=r.hide;i.init=r.init;return i}});
STK.register("comp.share.weimi",function(a){var b="分享到一个微米群组",c=a.common.trans.weimi;return function(b,d){function t(){return a.E("weimi_img")?a.E("weimi_img").value:""}var e={},f,g,h,i,j,k,l=!1,m={gid:0,desc:""},n=function(b){a.common.login.login.showLoginLayer(opt)},o=function(c){a.common.login.shareLogout(b)},p=function(){q();r();u();v()},q=function(){if(b==null||b!=null&&!a.core.dom.isNode(b))throw"[comp.share.weimi]:argsCheck()-The param node is not a DOM node."},r=function(){f=a.kit.dom.parseDOM(a.core.dom.builder(b).list);h=f.weimiContent;if(!h)throw" no avaliable Dom node found.";i=h.getAttribute("default_text")},s={show:function(){h&&(h.value=i);var a=function(){f.weimi_box.style.display="none";f.weimi_auth.style.display=""},b=function(){f.weimi_box.style.display="";f.weimi_auth.style.display="none";j.init()};c.getTrans("is_auth",{onComplete:function(c){c.code==="100000"&&c.data===1?b():a()},onFail:function(){a()}}).request({})},onLoading:function(){s.setShareStatus(0)},onLoaded:function(){s.setShareStatus(1)},setShareStatus:function(a){if(a){l=!0;f.weimiSend.className="WB_btn_share"}else{l=!1;f.weimiSend.className="WB_btn_share_dis"}},showGroup:function(a){j.isShow()?j.hide():j.show()},selectGroup:function(a,b){m=b},weimiWarn:function(b){b=b||"分享失败，请稍后再试";if(!k){k=a.ui.tip(b,{timeout:2e3});k.setPosition(f.weimi_box.parentNode,"center",{t:20})}k.setContent(b)},weimiAuth:function(b){c.getTrans("register",{onComplete:function(b){if(b.code==="100000"){var c=a.core.util.URL(https://service.weibo.com/share/document.URL);c.setParam("weimi","1");document.location.href=c}else s.weimiWarn(b.msg)},onFail:null}).request({isAtt:f.followWeimi.checked?1:0});return!1},weimiSend:function(){if(!!l){m.href=$CONFIG.$refer;m.desc=encodeURIComponent(f.desc.innerHTML);var b=a.trim(h.value)==i?"":a.trim(h.value);m.share_desc=encodeURIComponent(b);m.img=t();s.setShareStatus(0);c.getTrans("send",{onComplete:function(a){if(a.code==="100000")window.location.href="https://service.weibo.com/share/success.php?refer="+$CONFIG.$refer+"&type=weimi&&rnd="+ +(new Date);else{s.weimiWarn(a.msg||"分享失败");s.setShareStatus(1)}},onFail:function(){s.setShareStatus(1)}}).request(m)}},toggleText:function(b){var b=a.fixEvent(),c=b.type,d=h,e=d.getAttribute("default_text");d.value==""&&c=="blur"?d.value=e:d.value==e&&c=="focus"&&(d.value="")}},u=function(){j=a.comp.share.weimiGroup(f.selectBox)},v=function(){g=a.core.evt.delegatedEvent(b);g.add("weimiGroup","click",s.showGroup);g.add("weimiAuth","click",s.weimiAuth);g.add("weimiSend","click",s.weimiSend);a.addEvent(h,"focus",s.toggleText);a.addEvent(h,"blur",s.toggleText);a.custEvent.add(j,"onSelect",s.selectGroup);a.custEvent.add(j,"onLoading",s.onLoading);a.custEvent.add(j,"onLoaded",s.onLoaded)},w=function(){g=null};p();e.destroy=w;e.show=s.show;return e}});
STK.register("common.trans.like",function(a){var b=location.host=="widget.weibo.com"?"":"/widget",c=a.kit.io.inter(),d=c.register;d("appkey_check",{url:b+"/widget/aj_appkey_check.php",method:"post"});d("like",{url:b+"/like/aj_like.php",method:"get"});d("unlike",{url:b+"/like/aj_unlike.php",method:"get"});return c});
STK.register("common.widget.userAction",function(a){var b=$CONFIG.$pageid=="share",c=window.location.protocol=="https:"?"https:":"http:",d=c+"//rs.sinajs.cn/tmp.gif?",e=[],f=(new Date).getTime();$CONFIG.$pageLoadTime=$CONFIG.$pageLoadTime||f;$CONFIG.$timeDiff=$CONFIG.$timeDiff||0;var g=function(){var a=(new Date).getTime()-$CONFIG.$timeDiff-$CONFIG.$pageLoadTime*1e3;a=Math.ceil(a/1e3);return a},h={add:function(a,c){!!b&&!!a&&e.push(g()+":"+a)},send:function(){var a=new Image,b=c+"//rs.sinajs.cn/tmp.gif?";b+="id=sharebutton&action=close";b+="&uid="+$CONFIG.$uid||0;b+="&result="+($CONFIG.$result||0);b+="&url="+encodeURIComponent(document.referrer);b+="&time="+g();b+="&behavior="+e.join(",");b+="&r="+(new Date).valueOf();a.src=b}};b&&a.addEvent(window,"beforeunload",function(){h.send()});return h});
STK.register("common.widget.threadUpload",function($){var _iframe,protocol=window.location.protocol=="https:"?"https:":"http:",url=protocol+"//service.weibo.com/share/aj_upload_pics.php",avarageTime=5e3;return function(conf){var that={},_form,_timer,conf=$.parseParam({url:url,files:null,uniqueID:"weibo_share_iframe_"+$.core.util.getUniqueKey(),method:"post",form:null,args:{},callback:null,timeout:$.core.func.empty},conf);if(conf.url=="")throw"threadUpload need url in parameters object";var createIframe=function(id){try{_iframe=document.createElement('<iframe name="'+id+'">')}catch(e){_iframe=document.createElement("iframe")}$.addEvent(_iframe,"load",function(){var cbk=eval(conf.callback);typeof cbk=="function"&&cbk({code:"100000"})});_iframe.style.display="none";_iframe.name=id;_iframe.id=id;document.body.insertBefore(_iframe,document.body.firstChild)};_iframe||createIframe(conf.uniqueID);if(conf.method=="get"){var params=[],args=conf.args;args.callback=conf.callback;for(var k in conf.args)params.push(k+"="+conf.args[k]);var parameter=params.join("&");_iframe.src=conf.url+"?"+parameter}else if(conf.method=="post"){var _form=conf.form;if(!_form){_form=$.C("form");_form.method=conf.method;$.core.util.hideContainer.appendChild(_form)}var parseArgs=function(){var a=conf.args;a.callback=conf.callback;for(var b in a){var c=$.sizzle("[name="+b+"]",_form);if(c.length>0)c[0].value=a[b]||"";else{var d=$.C("input");d.type="hidden";d.name=b;d.value=a[b]||"";_form.appendChild(d)}}};parseArgs();_form.action=conf.url;_form.method=conf.method;_form.target=_iframe.id;_form.submit();$.core.util.hideContainer.removeChild(_form);_form=null}var timeout=function(a){clearTimeout(_timer);typeof a=="function"&&a()};/^[0-9]+$/.test(conf.files)&&(_timer=setTimeout(function(){timeout(conf.timeout)},conf.files*avarageTime));var destroy=function(){_form&&$.core.util.hideContainer.removeChild(_form);$.core.dom.removeChild(_iframe);_iframe=null;_form=null};that.destroy=destroy;return that}});
STK.register("comp.share.share",function(a){function by(a){var b=a.data,c="",d=bp("grouplayer").childNodes[0],e=b.length;if(e>4){d.style.width="110px";d.style.height="100px"}for(var f=0;f<e;f++)c+=m(bb.replace("###DELE###","selectgroup").replace("###TEXT###",b[f].gname).replace("###ICON###","i_conn_list").replace("###DATA###","gid="+b[f].gid+"&gname="+b[f].gname));d.innerHTML=c}function bx(){var b=bp("grouplayer");M&&(b.innerHTML=M);M=null;if(b)if(b.style.display!="none"){bp("group").childNodes[1].className="select_arrrow_down";b.style.display="none"}else{bp("group").childNodes[1].className="select_arrrow_up";b.style.display="block"}else{bp("group").childNodes[1].className="select_arrrow_up";a.insertHTML(bp("shareIt").parentNode.parentNode,ba,"beforeend")}}function bw(b){var c=bp(E+"Publisher"),d=bz[E],f=e(c.value),g;if("privateMsg"!==E||scope.uidsinfo.length!=0){bm("clickshare");var h=r(f);if("privateMsg"===E){if(h>300||h==0){c.focus();bu(c);return}g={appkey:scope.appkey,text:encodeURIComponent(f),uid:[],refer:$CONFIG.$refer};for(var i=0,j=scope.uidsinfo.length;i<j;i++)g.uid.push(scope.uidsinfo[i].uid);g.uid=g.uid.join(",")}else{if(h>2e3||h==0){c.focus();bu(c);return}g={content:encodeURIComponent(f+scope.short_url),styleid:1,from:scope.$pageid,sourceUrl:scope.sourceUrl||scope.source,appkey:scope.appkey||"",source:scope.source||"",refer:$CONFIG.$refer,url_type:scope.url_type?scope.url_type:"",object_type:scope.object_type?scope.object_type:"",visible:N,pic_ids:bF()||"",gid:O}}bq("privateMsg"===E);D=1;a.ajax({url:d.url,args:g,method:"post",onComplete:function(a){D=0;br();bz.weibo.success(a,g,"privateMsg"===E)},onFail:function(a){D=0;br();bz.weibo.fail(a,g,"privateMsg"===E)}});if(a.E("addLike").checked==!0&&x&&"privateMsg"!==E){var k=a.common.trans.like,l=k.getTrans("like",{onComplete:function(){x=!1},onFail:null}),m={url:scope.$refer||"",from:"thirdparty",app_src:scope.$appsrc};l.request(m)}}}function bv(b){if(!D)if(bl()!=""&&"weibo"===E&&!bE){bB.loading();D=1;a.common.widget.threadUpload({files:bk().length,args:{share_pic:bl()},callback:"scope.upload",timeout:function(){bH()}})}else bw(b)}function bu(a,b,c,d){b=b||["#fee","#fdd","#fcc","#fdd","#fee","#fff"];c=c||2;d=d||50;var e=0,f=b.length,g=c*f,h=setInterval(function(){a.style.backgroundColor=b[e%f];e++;e==g&&clearInterval(h)},d)}function bt(){/\((iPhone|iPad|iPod)/i.test(navigator.userAgent)||function(b,c){var d,e,f=c.documentElement;d=f&&f.clientWidth?f.clientWidth:c.body.clientWidth;e=f&&f.clientWidth?f.clientHeight:c.body.clientHeight;var g=650,h=450;if(scope.picLst&&scope.picLst.length>0||scope.isvideo)h=700;a.E("pl_share")&&(h=a.E("pl_share").offsetHeight+80);if(d<g||e<h){b.resizeTo(g,h);setTimeout(function(){a.common.channel.login.fire("resize",{})},10)}try{g=(b.screen.width-g)/2;h=(b.screen.height-h)/2;b.moveTo(g,h)}catch(i){}}(window,document)}function bs(){return scope.$isLogin()?!0:!1}function br(){a.module.mask.hide();bp("shareWait").style.display="none"}function bq(b){var c=bp("shareWait");a.common.login.login.close();a.module.mask.show();b&&(c.innerHTML=b==null?$:_);c.style.display=""}function bp(b){return a.E(b)}function bo(a){return t.createElement(a)}function bn(b){var c=b||{},d=b.success;c.lang=$CONFIG.language?$CONFIG.language:"zh-cn";c.css="off";typeof d=="function"&&(c.success=function(){p(d);var a=scope.loginKit().uid,b=scope.$refer?scope.$refer:"";(new Image).src="../../rs.sinajs.cn/rc891.gif?uid="+a+"&appid="+scope.appkey+"&refer="+b+"&_rnd="+ +(new Date)});a.common.login.login.showLoginLayer(c)}function bm(a){var b=scope.loginKit().uid,c=scope.$refer?scope.$refer:"";(new Image).src="../../rs.sinajs.cn/tmpf0c1.gif?id=sharebutton&amp;action="+a+"&uid="+b+"&refer="+encodeURIComponent(c)+"&r="+ +(new Date)}function bl(){return bj(bk())}function bk(){var b=[];if(a.E("picbox"))b=y.getPics();else{var c=a.sizzle("li",a.E("picContain")),d=c.length;for(var e=0;e<d;e++){var f=c[e];a.trim(f.className)=="plus_cur"&&b.push(bi[e])}}return b}var b=a.core,c=b.evt.addEvent,d=b.evt.getEvent,e=b.str.trim,f=b.evt.removeEvent,g=b.dom.sizzle,h=b.io.ajax,i=b.evt.fireEvent,j=b.evt.stopEvent,k=b.dom.getSize,l=b.dom.setXY,m=a.kit.extra.language,n=a.common.login.login.close,o=a.common.editor.simpleEditorNew,p=a.common.login.getUserInfo,q=b.arr.indexOf,r=a.common.editor.getLength,s=a.common.login.getLoginStatus,t=document,u=0,v={gpID:0,gpName:"",pic:"",isFav:0,isMark:0},w=1,x=!0,y,z,A,B={},C=1,D=0,E=/message=1&|message=1$/.test(document.URL)?"privateMsg":"weibo",F,G,H,I,J,K,L,M,N=0,O,P,Q,R,S,T='<#et userlist data><#list data.list as list><#if (list.count == "null")><p class="slt_title">${list.groupname}</p><#else><p class="slt_title${list.defaultOpen==1?\' target_on\' : \'\'}" action-type="folder_contact" action-data="group=${list.groupid}"><span class="slt_arr"></span>${list.groupname}[<span>${list.count}</span>]</p></#if><#if (list.count != 0)><ul class="WB_userList clearfix"${list.defaultOpen==1?\'\' : \' style="display:none;"\'}><#list list.info as item><li ${item.default_choised == 1 ? \'class="WB_slted"\' : \'\'}><a action-type="choice_contact" action-data="uid=${item.uid}&name=${item.name}" href="#" onclick="return false;" class="clearfix" title="${item.name}"><span class="sl_Uavatar"><img src="${item.icon}" alt="${item.name}" /><i class="WB_st_${(item.online_status == 1)?"On":"Off"}L"></i></span><span class="sl_Uname"><span calss="name">${item.short_name}</span><#if (item.verified_type == 0)><i class="WB_approve"></i><#elseif ( item.verified_type >= 1 && item.verified_type <= 7)><i class="WB_approve_co"></i></#if></span></a></li></#list></ul></#if></#list>',U=m('<div class="nousers"><span class="WB_loadingS"></span><span class="WB_icon_txt">#L{正在加载好友列表}</span></div>'),V=m('<div class="nousers"><span class="WB_icon_txt">#L{加载好友列表失败，请} <a href="#" onclick="return false;" action-type="retry">#L{重试}</a></span></div>'),W=m('<div class="nousers"><span class="WB_tipS_warn"></span><span class="WB_icon_txt">#L{无相关好友，请确认后重新录入}</span></div>'),X=m('<#et userlist data><#list data.list as list><span class="slt_user"><span class="slt_uid">${list.name}</span><span class="WB_vline"></span><a class="slt_cancel" href="#" title="#L{删除}" onclick="return false;" action-type="delete_contact" action-data="uid=${list.uid}"></a></span></#list>'),Y=m('<span class="txt_con">#L{请输入您的好友昵称}</span>'),Z=m('<div style="top:###top###px;left:150px;" class="WB_tip_sg"><div class="WB_tip_sg_inner"><span class="WB_tipS_warn"></span><span class="WB_icon_txt">只能选择3位好友</span></div></div>'),$=m('<span class="WB_loadingB"></span><span class="WB_icon_txt">正在发布微博，请稍候</span>'),_=m('<span class="WB_loadingB"></span><span class="WB_icon_txt">正在发布私信，请稍候</span>'),ba=m('<div class="layer_menu_list" id="grouplayer"><ul class="grouping_list"><li class="grouping_item"><a class="grouping_item_link" href="#0" title="" onclick="return false;" action-type="grouplistshow" action-data="visible=3"><i class="grouping_ico i_conn_list"></i>#L{分组可见}</a></li></ul></div>'),bb='<li class="grouping_item"><a class="grouping_item_link" href="#0" title="" onclick="return false;" action-type="###DELE###" action-data="###DATA###"><i class="grouping_ico ###ICON###"></i>#L{###TEXT###}</a></li>',bc=m("#L{密友圈}"),bd=m("#L{公开}"),be=m("#L{分组可见}"),bf=m('<ul class="grouping_list"></ul><div class="line"></div><div class="back_link_container"><a class="back_link" href="#0" title="" onclick="return false;" action-type="selectreturn">#L{返回}</a></div>'),bg='<#et piclist data><div class="WB_widget WB_widget_layer" node-type="outer"><table><tbody><tr><td><div class="layer_plain_container"><div class="layer_content"><div class="img_upload_status_display"><div class="display_inner"><p class="status_note" node-type="msg">#L{图片上传中，请耐心等待...}</p><div class="status_img_display" node-type="inner"></div></div></div></div></div></td></tr></tbody></table></div>';"</#et>";var bh='<#et piclist data><#list data as img><cite class="status_img_container status_loading" node-type="${img.key}" ><img src="${img.src}" class="status_img"><i class="status_mark_loading"></i><i class="status_mark status_mark_success"></i><a action-type="del" action-data="key=${img.key}&src=${img.enSrc}" title="delete" href="javascript:;" class="status_mark_handle status_mark_handle_del"></a></cite></#list></#et>',bi=scope.picLst.slice(0);scope.isvideo&&bi.pop();var bj=function(b){var c=[];if(a.isArray(b)&&b.length>0)for(var d=0,e=b.length;d<e;d++)c.push(encodeURIComponent(b[d]));return c.join(";")},bz={weibo:{url:"/share/aj_share.php",success:function(b,c,d){var e=b.code;if(e==="A00006"||e=="M02005"||e==="100000"){var f=bz.success.url;f+="?urlpara="+bz.formatURL(b,c,d);scope.appkey&&(f+="&appkey="+scope.appkey);var g=/(^|)url=([^\&]*)(\&|$)/ig.exec(location.href.toString());g&&g[2]&&(f+="&aburl="+g[2]);d&&(f+="&message=1");$CONFIG.$result=1;var h=bC.length,i=bk().length-h;window.location.href=f+"&refer="+$CONFIG.$refer+"&ecode="+e+"&language="+(scope.language?scope.language:"")+"&ismark="+v.isMark+"&count="+(h+"|"+i)+"&rnd="+ +(new Date)}else if(e=="20169"||e=="20168")window.open(b.data,"_blank");else{$CONFIG.$result=0;a.common.widget.userAction.add(14);window.location.href=bz.fail.url+"?urlpara="+bz.formatURL(b,c,d)+(d?"&message=1&uids="+b.data.join(",")+"&uidsnum="+c.uid.split(",").length:"")+"&refer="+$CONFIG.$refer+"&ecode="+(e||"")+"&language="+(scope.language?scope.language:"")+"&rnd="+ +(new Date)}},fail:function(b,c,d){$CONFIG.$result=0;a.common.widget.userAction.add(14);window.location.href=bz.fail.url+"?urlpara="+bz.formatURL(b,c,d)+(d?"&message=1&uids="+b.data.join(",")+"&uidsnum="+c.uid.split(",").length:"")+"&refer="+$CONFIG.$refer+"&ecode=&rnd="+ +(new Date)}},privateMsg:{url:"/share/aj_message.php"},getProduct:{url:"/share/aj_getproduct.php",success:function(){},fail:function(){}},success:{url:"/share/success.php"},fail:{url:"/share/fail.php"},formatURL:function(b,c,d){var e=c.text||c.content,f=a.core.util.URL(https://service.weibo.com/share/document.URL);f.setParam("title","");if(d){f.setParam("message",1);var g=b.code;(g==="A00006"||g=="M02005"||g==="100000")==!1&&f.setParam("uids",b.data.join(","))}f=f.toString().replace("&title=","");f+="&title="+e;f=encodeURIComponent(f);f.length>7e3&&(f="");return f}},bA={editorKeyUp:function(a){a=a||d(a);var b=a.target||a.srcElement,c=b.id,e=b.value,f=r(e),g="WB_btn_share";if(c!="privateMsgPublisher"&&(f>2e3||f==0)||c==="privateMsgPublisher"&&(scope.uidsinfo.length==0||f>2e3||f==0)||scope&&scope.loginStatus&&scope.loginStatus.code&&scope.loginStatus.code==-1)g="WB_btn_share_dis";bp("shareIt").className=g},share:function(b){if(bp("shareIt").className!="WB_btn_share_dis")if(bs()){D=0;bv()}else{bn({success:function(a){D=0;scope.$uid=scope.loginKit().uid;bv(a)}});a.common.widget.userAction.add(8)}},groupList:function(b){b=a.core.evt.fixEvent(b);if(b.target.parentNode&&b.target.parentNode.className=="select_link"||b.target.className=="grouping_select")bs()?bx():bn({success:function(){bx()}});else if(!(b.target.className=="grouping_item_link"||b.target.parentNode&&b.target.parentNode.className=="grouping_item_link"||b.target.className=="back_link")){var c=bp("grouplayer");M&&(c.innerHTML=M);M=null;bp("group").childNodes[1].className="select_arrrow_down";c&&(c.style.display="none")}},selectmiyou:function(a){N=2;bp("group").innerHTML=m('<span class="select_note">#L{密友圈}</span><i class="select_arrrow_down"></i>');var b=bp("grouplayer"),c=m(bb.replace("###DELE###","selectpublic").replace("###TEXT###",bd).replace("###ICON###","i_conn_public").replace("###DATA###","visible=0")),d=m(bb.replace("###DELE###","grouplistshow").replace("###TEXT###",be).replace("###ICON###","i_conn_list").replace("###DATA###","visible=3"));b.childNodes[0].innerHTML=c+'<li class="line"></li>'+d;b.style.display="none"},selectpublic:function(a){N=0;bp("group").innerHTML=m('<span class="select_note">#L{公开}</span><i class="select_arrrow_down"></i>');var b=bp("grouplayer"),c=m(bb.replace("###DELE###","grouplistshow").replace("###TEXT###",be).replace("###ICON###","i_conn_list").replace("###DATA###","visible=3"));b.childNodes[0].innerHTML=c;b.style.display="none"},grouplistshow:function(b){M=bp("grouplayer").innerHTML;bp("grouplayer").innerHTML=bf;a.ajax({url:"/widget/public/aj_userownlists.php",args:{wsrc:$CONFIG.wsrc||"app_sharepop",list_type:1},method:"get",onComplete:function(a){by(a)},onFail:function(a){by(a)}})},selectreturn:function(a){bp("grouplayer").innerHTML=M;M=null},selectgroup:function(a){N=3;O=a.data.gid;var b=bp("grouplayer");b.innerHTML=M;M=null;b.style.display="none";bp("group").innerHTML='<span class="select_note">'+a.data.gname+'</span><i class="select_arrrow_down"></i>';var c=m(bb.replace("###DELE###","selectpublic").replace("###TEXT###",bd).replace("###ICON###","i_conn_public").replace("###DATA###","visible=0")),d=m(bb.replace("###DELE###","grouplistshow").replace("###TEXT###",be).replace("###ICON###","i_conn_list").replace("###DATA###","visible=3"));b.childNodes[0].innerHTML=c+'<li class="line"></li>'+d},weibo:function(){D=0;bp("group").style.display="block";bp("group").childNodes[1].className="select_arrrow_down";bp("picContent")&&(bp("picContent").parentNode.style.display="");bp("action").style.display="block";bp("like").style.display="block"},privateMsg:function(){D=0;bp("action").style.display="block";bp("group").style.display="none";var b=bp("grouplayer");b&&(b.style.display="none");M&&(b.innerHTML=M);if(a.sizzle('div[action-type="folder"]',bp("privateMsgDiv")).length>0){if(bp("privateMsgPublisher").getAttribute("bind")==null){a.addEvent(bp("privateMsgPublisher"),"click",bA.friendLayerControl);bp("privateMsgPublisher").setAttribute("bind",!0)}a.trim(bp("privateMsgPublisher").value).length==0||scope.uidsinfo.length==0?bp("shareIt").className="WB_btn_share_dis":bp("shareIt").className="WB_btn_share";bA.showSelectedList();if(bA.privateMsgDelegate==null){F=a.core.evt.delegatedEvent(bp("privateMsgDiv"));F.add("folder","click",bA.showPrivateContact);F.add("active_input","click",bA.activeInput);F.add("delete_contact","click",bA.deleteFriend);F.add("choice_contact","click",bA.choiseFriend);F.add("folder_contact","click",bA.folderContact);F.add("retry","click",bA.retryGetContact);bA.privateMsgDelegate=!0}}else bp("shareIt").className="WB_btn_share_dis";bp("picContent")&&(bp("picContent").parentNode.style.display="none");bp("like").style.display="none";y&&y.hide();bB.hide()},weimi:function(){z&&z.show();bp("like").style.display="none";bp("action").style.display="none";bp("picContent")&&(bp("picContent").parentNode.style.display="none");y&&y.hide();bB.hide()},friendLayerControl:function(a){var b=bA.getPrivateMsgNode('div[action-type="folder"]');b.setAttribute("isShow",1);bA.showPrivateContact({el:b})},stopEvent:function(){a.stopEvent()},showPrivateContact:function(b){if(b.el&&typeof b.el.getAttribute!="undefined"){var c=b.el,d;if(c.getAttribute("isShow")!="1"){c.setAttribute("isShow",1);c.parentNode.className="WB_sltor complete_slt clearfix";bA.showNameSuggestInput(a.kit.dom.firstChild(a.core.dom.prev(c)),!0);a.core.dom.prev(c).setAttribute("action-type","");d=a.kit.dom.lastChild(a.core.dom.prev(c));d!=null&&d.tagName.toLowerCase()=="div"&&d.className=="slt_panel"?d.style.visibility="visible":a.core.dom.addHTML(a.core.dom.prev(c),'<div class="slt_panel">'+U+"</div>");bA.getContact();setTimeout(function(){a.addEvent(bp("privateMsgDiv"),"click",bA.stopEvent);a.addEvent(document.body,"click",bA.friendLayerControl)},1e3)}else{c.setAttribute("isShow",null);c.parentNode.className="WB_sltor clearfix";bA.showNameSuggestInput(a.kit.dom.firstChild(a.core.dom.prev(c)),!1);a.core.dom.prev(c).setAttribute("action-type","active_input");d=a.kit.dom.lastChild(a.core.dom.prev(c));if(d!=null&&d.tagName.toLowerCase()=="div"&&d.className=="slt_panel"){d.style.visibility="hidden";d.innerHTML=U}a.removeEvent(document.body,"click",bA.friendLayerControl)}}},activeInput:function(b){b!=null&&b.el!=null&&bA.showPrivateContact({el:a.core.dom.next(b.el)})},showNameSuggestInput:function(b,c){var d=b,e,f=a.kit.dom.lastChild(d);if(c){if(scope.uidsinfo.length<3&&(f&&f.tagName.toLowerCase()!="input"||f==null)){f&&f.className!="slt_user"&&(d.innerHTML="");if(e==null){e=a.C("input");e.className="slt_ipt";a.addEvent(e,"focus",bA.serachFocus);a.addEvent(e,"blur",bA.serachBlur)}b.appendChild(e);try{e.focus()}catch(g){}}}else if(f&&f.tagName.toLowerCase()=="input"){a.core.dom.removeNode(f);a.kit.dom.lastChild(d)==null&&(d.innerHTML=Y)}},serachFocus:function(b){var c=a.fixEvent(b),d=c.target||c.srcElement;K=setInterval(function(){if(d.value!=I){I=d.value;a.trim(I)==""?bA.showContactList():bA.serachFriend(I)}},200)},serachBlur:function(){clearInterval(K)},serachFriend:function(b){var c=bA.getPrivateMsgNode('div[class="slt_panel"]');c.innerHTML=U;J="serachFriend";var d=a.common.trans.editor.getTrans("at",{onComplete:function(b){switch(b.code){case"100000":if(b.data.length==0)bA.showContactListError(W);else{var c=b.data,d={wsrc:$CONFIG.wsrc||"app_sharepop",groupname:m("#L{搜索到} "+c.length+" #L{位相关好友}"),count:"null",defaultOpen:1,info:[]};for(var e=0,f=c.length;e<f;e++)c[e].verified&&a.bLength(c[e].name)>12?c[e].short_name=a.leftB(c[e].name,10)+"…":a.bLength(c[e].name)>16?c[e].short_name=a.leftB(c[e].name,14)+"…":c[e].short_name=c[e].name;d.info=c;bA.showContactList([d])}break;default:bA.showContactListError(V)}},onFail:function(){bA.showContactListError(V)}});d.request({appkey:$CONFIG.source_appkey||"",q:b,type:1,info:1})},deleteFriend:function(b){var c=b.data,d=scope.uidsinfo,e=[];a.core.arr.foreach(d,function(a){a.uid!=c.uid&&e.push(a)});scope.uidsinfo=e;bA.showSelectedList();bA.showContactList()},choiseFriend:function(b){var c=b.data,d=scope.uidsinfo,e=d.length,f=b.el.parentNode.className!="WB_slted"?1:0;if(f)if(e<3)d.push({uid:c.uid,name:c.name});else{bA.friendMaxError();return}else{var g=[];a.core.arr.foreach(d,function(a){a.uid!=c.uid&&g.push(a)});scope.uidsinfo=g}bA.showSelectedList();bA.showContactList()},friendMaxError:function(){var b=bA.getPrivateMsgNode('div[class="slt_panel"]');if(bA.getPrivateMsgNode('div[class="WB_tip_sg"]')==null){var c=a.builder(Z.replace("###top###",b.scrollTop+71));b.appendChild(c.box)}if(L!=null){clearTimeout(L);L=null}L=setTimeout(function(){bA.getPrivateMsgNode('div[class="WB_tip_sg"]')&&a.core.dom.removeNode(bA.getPrivateMsgNode('div[class="WB_tip_sg"]'));clearTimeout(L);L=null},1e3)},folderContact:function(a){for(var b=0,c=H.length;b<c;b++)H[b].defaultOpen=b==a.data.group&&H[b].defaultOpen!=1?1:0;bA.showContactList()},retryGetContact:function(a){J=="serachFriend"?bA.serachFriend(I):bA.getContact()},getContact:function(){if(H==null){var b=a.common.trans.share.getTrans("friend",{onComplete:function(b){switch(b.code){case"100000":H=b.data;for(var c=0,d=H.length;c<d;c++){c==0&&(H[c].defaultOpen=1);H[c].count=H[c].info.length;H[c].groupid=c;for(var e=0,f=H[c].info.length;e<f;e++){var g=H[c].info[e];g.verified&&a.bLength(g.name)>12?g.short_name=a.leftB(g.name,10)+"…":a.bLength(g.name)>16?g.short_name=a.leftB(g.name,14)+"…":g.short_name=g.name}}bA.showContactList();break;default:bA.showContactListError(V)}},onFail:function(){bA.showContactListError(V)}});b.request({appkey:scope.appkey||""})}else bA.showContactList()},showContactList:function(b){var c=a.core.util.easyTemplate(T),d=scope.uidsinfo;typeof b=="undefined"&&(b=H);if(b!=null){for(var e=0,f=b.length;e<f;e++)for(var g=0,h=b[e].info.length;g<h;g++){b[e].info[g].default_choised=0;a.core.arr.foreach(d,function(a){a.uid==b[e].info[g].uid&&(b[e].info[g].default_choised=1)})}var i=c({list:b}).toString(),j=bA.getPrivateMsgNode('div[class="slt_panel"]');j.innerHTML=i}},showContactListError:function(a){var b=bA.getPrivateMsgNode('div[class="slt_panel"]');b.innerHTML=a||W},showSelectedList:function(){var b=bA.getPrivateMsgNode('div[class="WB_slt_iptBox"]'),c=scope.uidsinfo;if(c.length==0)if(b.parentNode.parentNode.className!="WB_sltor clearfix"){b.innerHTML="";bA.showNameSuggestInput(b,!0)}else b.innerHTML=Y;else{var d=a.core.util.easyTemplate(X),e=d({list:c}).toString(),f=a.kit.dom.lastChild(b);f&&f.tagName.toLowerCase()=="input"&&bA.showNameSuggestInput(b,!1);b.innerHTML=e;c.length<3&&b.parentNode.parentNode.className!="WB_sltor clearfix"?bA.showNameSuggestInput(b,!0):bA.showNameSuggestInput(b,!1)}bp("shareIt").className=scope.uidsinfo.length==0||a.trim(bp("privateMsgPublisher").value)==""?"WB_btn_share_dis":"WB_btn_share"},getPrivateMsgNode:function(b){var c=bp("privateMsgDiv"),d=a.sizzle(b,c);d.length>0?d=d[0]:d=null;return d},tab:function(a){a=a||d(a);var b=a.target||a.srcElement,c=b.id;c&&c!=="share_tab"&&"weibo privateMsg weimi".replace(/[^ ]+/g,function(a){var b="none",d="";if(c===a){b="";d="wwg_cur";E=a;bA[a]();a!=="weimi"&&i(B[a],"keyup")}if(bp(a)){bp(a).className=d;bp(a+"Div").style.display=b}})},cancelPic:function(){},logoutCb:function(a){D=1;C=1;bp("shareIt").className="WB_btn_share_dis"},selectPics:function(b){var c=b.el,d=b.data;a.hasClassName(c,"plus_cur")?a.removeClassName(c,"plus_cur"):a.addClassName(c,"plus_cur");bA.updateInfo()},updateInfo:function(){var b=a.sizzle(".plus_cur",a.E("picContain")),c=b.length,d=m("#L{已选择}"+c+"#L{张}，#L{还能选择}"+parseInt(bi.length-c)+"#L{张}");a.E("picinfo").innerHTML=d;bA.picChange(null,{msg:d,len:c})},picChange:function(b,c){a.E("picinfo").innerHTML=c.msg;c.src&&(a.sizzle(".weibo_img")[0].src=c.src);var d=a.E("picbox");if(c.len<=0){d&&(d.className="weibo_img_box mark_status_normal");w=0}else{d&&(d.className="weibo_img_box mark_status_checked");w=1}},resize:function(){y&&y.rePos()}},bB={nodes:{},clsUrl:function(a){a=a.replace(/[^\w+]/g,"");return a},getTemp:function(){var b=bk(),c=[];a.foreach(b,function(a,b){c.push({key:bB.clsUrl(a),src:a,enSrc:encodeURIComponent(a)})});var d=a.core.util.easyTemplate(bh,c).toString(),e=a.builder(d),f=a.kit.dom.parseDOM(e.list);S=f;return e},show:function(){if(!P){var b,c;P=a.module.layer(m(bg));Q=P.getOuter();b=P.getInner();c=bB.getTemp().box;b.appendChild(c);document.body.appendChild(Q);bB.nodes=a.kit.dom.parseDOM(P.getDomList());R=a.core.evt.delegatedEvent(Q);R.add("del","click",bB.del)}var d=a.core.dom.position(a.E("weiboPublisher"));Q.style.left=d.l+"px";Q.style.top=d.t+"px"},loading:function(){bB.show();y.hide();a.common.widget.userAction.add(11)},success:function(){var a=m("#L{图片上传成功，开始发送微博...}");bB.setText(a)},fail:function(b,c){var d=m('<i class="WB_tipS_warn"></i>#L{已成功上传}'+b+"#L{张图片}，"+c+"#L{张上传失败}");bB.setText(d);a.common.widget.userAction.add(12)},hide:function(){P&&P.hide()},setText:function(a){bB.nodes.msg.innerHTML=a},del:function(b){var c=b.data;a.removeNode(b.el.parentNode);delete S[c.key];bD.push(decodeURIComponent(c.src))}},bC=[],bD=[],bE=!1,bF=function(){var b=[];bC.sort(bG);a.core.arr.foreach(bC,function(a,c){b.push(a.pid)});return b.join(",")},bG=function(a,b){return q(decodeURIComponent(a.src),bi)>q(decodeURIComponent(b.src),bi)?1:-1},bH=function(){bw()},bI=function(b){if(b.code!="100000"){bE=!0;var c=b.data,d=S[bB.clsUrl(decodeURIComponent(c.src))],e=c.pid;if(d){if(e){if(a.core.arr.inArray(decodeURIComponent(c.src),bD))return;bC.push(c);d.className="status_img_container status_complete"}else d.className="status_img_container status_loading status_loading_mouseover";if(bC.length==bk().length){bB.success();bw()}}}};return function(b,d){var e={},g=function(){if(top!=self)top.location=self.location;else{scope.loginKit().uid&&p();bt();try{y=a.comp.share.picSelector(b);z=a.comp.share.weimi(b)}catch(c){}j();h();scope&&(scope.upload=bI);bm("windowpv")}},h=function(){a.common.channel.login.register("logout",bA.logoutCb);a.common.channel.login.register("login",function(a){scope&&(scope.loginStatus=a);a.code==-1&&(bp("shareIt").innerHTML=m('<a id="shareIt" class="WB_btn_share_dis" title="#L{分享}" target="_blank" href="'+scope.reg2Url+'">#L{分享}</a>'));i(B[E],"keyup")});a.custEvent.add(y,"change",bA.picChange)},j=function(){c(bp("share_tab"),"click",bA.tab);B.weibo=bp("weiboPublisher");B.privateMsg=bp("privateMsgPublisher");o(bp("weiboDiv"),{limit:2e3,atSwitch:!0});o(bp("privateMsgDiv"),{limit:2e3,atSwitch:!0});a.E("shareIt").className="WB_btn_share";c(B.weibo,"keyup",bA.editorKeyUp);c(B.privateMsg,"keyup",bA.editorKeyUp);i(B.weibo,"keyup");c(bp("shareIt"),"click",bA.share);c(document.body,"click",bA.groupList);G=a.core.evt.delegatedEvent(b);G.add("grouplistshow","click",bA.grouplistshow);G.add("selectpublic","click",bA.selectpublic);G.add("selectgroup","click",bA.selectgroup);G.add("selectreturn","click",bA.selectreturn);G.add("pics","click",bA.selectPics);a.core.evt.hotKey.add(bp("weiboPublisher"),"ctrl+Enter",bA.share);/message=1&|message=1$/.test(document.URL)&&bA.privateMsg();/weimi=1&|weimi=1$/.test(document.URL)&&bp("weimi")&&a.core.evt.fireEvent(bp("weimi"),"click");c(a.sizzle(".WB_logo a")[0],"click",function(){a.common.widget.userAction.add(1)});c(a.E("addLike"),"click",function(a){var b=a.target||a.srcElement;b.checked||bm("cancellike")});c(window,"resize",bA.resize)},k=function(){f(B.weibo,"keyup",bA.editorKeyUp);f(B.privateMsg,"keyup",bA.editorKeyUp);f(bp("shareIt"),"click",bA.share);f(document.body,"click",bA.groupList);a.core.evt.hotKey.remove(bp("weiboPublisher"),"ctrl+Enter",bA.share);f(bp("share_tab"),"click",bA.tab);f(bp("cancelPic"),"click",bA.cancelPic);bz=null;bA=null;B=null};g();e.destroy=k;return e}});
STK.pageletM.register("pl.share.share",function(a){try{var b={},c=a.E("pl_share"),d=a.comp.share.share(c,b);return d}catch(e){}});
STK.register("common.login.status",function(a){function l(b,d){var e=f.replace("${nick}",d);e=e.replace("${domain}",scope.loginKit().uid);b.innerHTML=e+g;var h=c('[node-type="nick"]',b)[0];if(h){var i=a.core.dom.getSize(h).width;h=c('[node-type="reg2arrow"]',b)[0];h&&(h.style.right=i+17+"px")}b=null}function k(a){return a.innerHTML.split("http://account.weibo.com/bindsns/urlfacebook?from=api").length>1?'<span class="WB_vline">|</span><a class="bind_link" href="http://new.account.weibo.com/bindsns/urlfacebook?from=api" target="_blank">绑定Facebook帐号</a>':""}function j(b,d){var e=f.replace("${nick}",d);e=e.replace("${domain}",scope.loginKit().uid);e+=k(b);b.innerHTML=e;b=null;var g=c('[node-type="nick"]',b)[0];g&&a.addEvent(g,"click",function(){a.common.widget.userAction.add(9)})}function i(a){a.innerHTML=e;a=null}function h(a,b){b=b||{};switch(b.code){case 0:j(a,b.nick);break;case-1:l(a,b.nick);break;case-2:break;default:j(a)}}var b=a.kit.extra.language,c=a.core.dom.sizzle,d=scope.reg2Url?scope.reg2Url:"http://"+(document.domain=="www.weibo.com"?"www.weibo.com":"weibo.com")+"/signup/signup.php?c=&type=&inviteCode=&code=&spe=&lang=zh_cn",e=b('#L{加入微博一起分享新鲜事} <a href="javascript:;" action-type="login">#L{登录}</a><span class="WB_vline">|</span><a href="'+(scope.regUrl?scope.regUrl:"javascript:;")+'" target="_blank">#L{注册}</a>'),f=b('<a node-type="nick" href="http://weibo.com/u/${domain}" target="_blank">${nick}</a><span class="WB_vline">|</span><a href="javascript:;" action-type="logout">#L{换个帐号}</a>'),g=b('<div class="WB_tips_top"><div class="tips_inner"><span class="WB_tipS_warn"></span><span class="WB_icon_txt">#L{您的登录状态发生改变，}<a href="//weibo.com" target="_blank">#L{点击登录}</a></span></div><div node-type="reg2arrow" class="tips_arr"></div></div>');return{setLogin:h,setLogout:i}});
STK.register("common.login.shareLogout",function(a){function d(c){c=c||{};var d={};d.lang=typeof $CONFIG!="undefined"&&$CONFIG.language?$CONFIG.language:"zh-cn";d.css="off";d.success=function(b,c){a.common.login.getUserInfo();location.reload()};d.onBeforeLogin=function(){var c="http://"+location.host+"/ajaxlogin.php";/^service\./.test(location.host)?c="http://"+location.host+"/sso/login.php":/^v\.t/.test(location.host)&&(c="http://"+location.host+"/share/login.php");b=a.C("div");b.style.cssText="width:1px;height:1px;overflow:hidden;position:absolute;left:-1000px;top:-1000px;";var d=a.C("iframe");d.src="http://weibo.com/logout.php?backurl="+encodeURIComponent(c+"?framelogin=1&callback=parent.STK.logonBack");b.appendChild(d);document.body.appendChild(b)};a.common.login.login.showLoginLayer(d)}var b,c;return function(b){c=b;a.common.widget.userAction.add(10);d()}});
STK.register("common.widget.log",function(a){var b={app_sharebutton:1,app_followbutton:2,app_livestream:4,app_listweibo:5,app_weiboshow:6,app_commentbox:7};return function(c){var d=a.core.obj.parseParam({vsrc:"app_weiboshow",refer:"",step:1},c),e=scope.refer||scope.$refer||d.refer,f=scope.loginKit().uid||"",g=scope.appkey||$CONFIG.$appkey||$CONFIG.appkey||0,h=b[d.vsrc]||"",i="../../rs.sinajs.cn/rc891.gif?uid="+f+"&appid="+g+"&refer="+e+"&cat="+h+"&step="+d.step+"&rnd="+ +(new Date),j=new Image;j.src=i;j=null}});
STK.register("comp.share.login",function(a){return function(b,c){var d={},e,f=function(b){var c=a.core.evt.fixEvent(b);c=c.target;while(c){if(c.tagName.toLowerCase()=="a"&&c.getAttribute("action-type")!=null){a.core.evt.preventDefault();break}c=c.parentNode;if(c==document.body)break}},g=a.common.login.status,h=function(b){var c={};c.lang=typeof $CONFIG!="undefined"&&$CONFIG.language?$CONFIG.language:"zh-cn";c.css="off";c.success=function(){a.common.login.getUserInfo();a.common.widget.log({vsrc:"app_sharebutton",step:2});window.location.reload()};a.common.login.login.showLoginLayer(c);a.common.widget.log({vsrc:"app_sharebutton"});a.common.widget.userAction.add(2)},i=function(b){var c=a.parseURL(location.href),d=a.queryToJson(c.query);d.loginRnd=+(new Date);c=c.scheme+"://"+c.host+"/"+c.path+"?"+a.jsonToQuery(d);location.href="http://weibo.com/logout.php?backurl="+encodeURIComponent(c)},j={},k={},l={},m=function(){n();o();p();q();r();s()},n=function(){if(b==null||b!=null&&!a.core.dom.isNode(b))throw"[comp.share.login]:argsCheck()-The param node is not a DOM node.";c=a.core.obj.parseParam({html:""},c)},o=function(){e=a.core.evt.delegatedEvent(b);e.add("login","click",h);e.add("logout","click",i)},p=function(){a.common.login.getLoginStatus.isLogin()||h()},q=function(){a.addEvent(b,"click",f);var c=a.sizzle("a",b);if(c.length>1){a.addEvent(c[0],"click",function(){a.common.widget.userAction.add(2)});a.addEvent(c[1],"click",function(){a.common.widget.userAction.add(3)})}},r=function(){},s=function(){a.common.channel.login.register("login",function(a){g.setLogin(b,a);$CONFIG&&($CONFIG.$pageid==="shareSuccess"||$CONFIG.$pageid==="shareFail")&&(location.href=scope.backUrl+"&rnd="+ +(new Date))});a.common.channel.login.register("logout",function(a){g.setLogout(b,a)});a.common.channel.login.register("resize",function(b){a.common.login.login.resetLoginLayer()})},t=function(){a.removeEvent(b,"click",f);f=null;g=null;e.remove("login","logout");e=null};m();d.destroy=t;return d}});
STK.pageletM.register("pl.share.login",function(a){var b={},c=a.E("pl_share_login"),d=a.comp.share.login(c,b);return d});
STK.pageletM.start();
